eap {
  default_eap_type = ttls

  timer_expire = 60
  ignore_unknown_eap_types = no
  cisco_accounting_username_bug = no
  max_sessions = ${max_requests}

  tls-config tls-common {
    private_key_file = ${certdir}/server.key
    certificate_file = ${certdir}/server.pem
    ca_file = ${cadir}/ca.pem
    random_file = /dev/urandom

    cipher_list = "DEFAULT"
    ecdh_curve = "prime256v1"
    cache {
      enable = yes
      lifetime = 24 # hours
      max_entries = 255
    }
  }

  ttls {
    tls = tls-common
    default_eap_type = pap
    copy_request_to_tunnel = yes
    use_tunneled_reply = yes
    virtual_server = "inner-tunnel"
  }

  peap {
    tls = tls-common
    default_eap_type = mschapv2
    copy_request_to_tunnel = yes
    use_tunneled_reply = yes
    virtual_server = "inner-tunnel"
  }
}
